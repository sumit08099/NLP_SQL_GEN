[{"filePath":"C:\\Users\\ASUS\\Desktop\\NLP_SQL_GEN\\frontend\\src\\pages\\HomePage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[147,154],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchSchema'. Either include it or remove the dependency array.","line":65,"column":8,"nodeType":"ArrayExpression","endLine":65,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchSchema]","fix":{"range":[1921,1923],"text":"[fetchSchema]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n    Send,\r\n    Upload,\r\n    Loader2,\r\n    Table as TableIcon,\r\n    ChevronDown,\r\n    BrainCircuit,\r\n    ShieldCheck,\r\n    LogOut,\r\n    User as UserIcon,\r\n    Plus,\r\n    Zap,\r\n    Cpu,\r\n    RefreshCw,\r\n    Clock,\r\n    Download,\r\n    Trash2,\r\n    Layers,\r\n    Check,\r\n    ArrowRight,\r\n    Brain as BrainIcon,\r\n    Terminal\r\n} from 'lucide-react';\r\nimport { clsx } from 'clsx';\r\nimport { twMerge } from 'tailwind-merge';\r\n\r\nconst API_BASE_URL = 'http://localhost:8000';\r\n\r\nfunction cn(...inputs) {\r\n    return twMerge(clsx(inputs));\r\n}\r\n\r\nfunction HomePage() {\r\n    const [messages, setMessages] = useState([\r\n        {\r\n            role: 'assistant',\r\n            content: 'System Initialized. I am your AI Data Intelligence Layer. Upload a knowledge base (CSV/Excel) to begin deep-analysis within the secure environment.',\r\n            isIntro: true\r\n        }\r\n    ]);\r\n    const [query, setQuery] = useState('');\r\n    const [file, setFile] = useState(null);\r\n    const [tableName, setTableName] = useState('');\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [schema, setSchema] = useState('');\r\n    const [showTechDetails, setShowTechDetails] = useState({});\r\n    const [token] = useState(localStorage.getItem('token'));\r\n    const [username] = useState(localStorage.getItem('username') || 'Operative');\r\n    const [selectedForAmbiguity, setSelectedForAmbiguity] = useState([]);\r\n\r\n    const navigate = useNavigate();\r\n    const chatEndRef = useRef(null);\r\n\r\n    const scrollToBottom = () => {\r\n        chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchSchema();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        scrollToBottom();\r\n    }, [messages]);\r\n\r\n    const toggleTechDetails = (msgIndex) => {\r\n        setShowTechDetails(prev => ({\r\n            ...prev,\r\n            [msgIndex]: !prev[msgIndex]\r\n        }));\r\n    };\r\n\r\n    const handleLogout = () => {\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('username');\r\n        navigate('/login');\r\n    };\r\n\r\n    const handleFileUpload = async (e) => {\r\n        e.preventDefault();\r\n        if (!file || !tableName) return;\r\n\r\n        setIsUploading(true);\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n        formData.append('table_name', tableName);\r\n\r\n        try {\r\n            await axios.post(`${API_BASE_URL}/upload`, formData, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            setMessages(prev => [...prev, {\r\n                role: 'assistant',\r\n                content: `Node Synchronized. Target \"${tableName}\" has been successfully ingested into the persistent knowledge layer. I have analyzed its structure and am ready for queries.`\r\n            }]);\r\n            fetchSchema();\r\n            setFile(null);\r\n        } catch (error) {\r\n            setMessages(prev => [...prev, {\r\n                role: 'assistant',\r\n                content: `Sync Error: ${error.response?.data?.detail || error.message}`\r\n            }]);\r\n        } finally {\r\n            setIsUploading(false);\r\n        }\r\n    };\r\n\r\n    const fetchSchema = async () => {\r\n        try {\r\n            const response = await axios.get(`${API_BASE_URL}/schema`, {\r\n                headers: { Authorization: `Bearer ${token}` }\r\n            });\r\n            setSchema(response.data.schema);\r\n        } catch (error) {\r\n            console.error('Error fetching schema:', error);\r\n        }\r\n    };\r\n\r\n    const handleDownload = async (sql, filename = \"analyzed_data.csv\") => {\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('sql', sql);\r\n            const config = {\r\n                headers: { Authorization: `Bearer ${token}` },\r\n                responseType: 'blob'\r\n            };\r\n            const response = await axios.post(`${API_BASE_URL}/export`, formData, config);\r\n\r\n            const url = window.URL.createObjectURL(new Blob([response.data]));\r\n            const link = document.createElement('a');\r\n            link.href = url;\r\n            link.setAttribute('download', filename);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.remove();\r\n        } catch (error) {\r\n            console.error('Download failed:', error);\r\n        }\r\n    };\r\n\r\n    const handleSend = async (forcedQuery = null) => {\r\n        const queryToSend = forcedQuery || query;\r\n        if (!queryToSend.trim()) return;\r\n\r\n        const userMsg = { role: 'user', content: queryToSend };\r\n        setMessages(prev => [...prev, userMsg]);\r\n        setQuery('');\r\n        setIsProcessing(true);\r\n\r\n        try {\r\n            const formData = new FormData();\r\n            formData.append('query', queryToSend);\r\n\r\n            const config = { headers: { Authorization: `Bearer ${token}` } };\r\n            const response = await axios.post(`${API_BASE_URL}/chat`, formData, config);\r\n\r\n            setMessages(prev => [...prev, {\r\n                role: 'assistant',\r\n                content: response.data.answer,\r\n                sql: response.data.sql,\r\n                data: response.data.data,\r\n                plan: response.data.plan,\r\n                reflection: response.data.reflection,\r\n                is_ambiguous: response.data.is_ambiguous,\r\n                potential_matches: response.data.potential_matches\r\n            }]);\r\n        } catch (error) {\r\n            let errorMsg = error.response?.data?.detail || error.message;\r\n            if (error.response?.status === 401) {\r\n                handleLogout();\r\n            } else {\r\n                setMessages(prev => [...prev, {\r\n                    role: 'assistant',\r\n                    content: `System Error: ${errorMsg}`\r\n                }]);\r\n            }\r\n        } finally {\r\n            setIsProcessing(false);\r\n        }\r\n    };\r\n\r\n    const clearMessages = () => {\r\n        setMessages([]);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex h-screen bg-[#020617] text-slate-100 overflow-hidden font-sans selection:bg-brand-500/30\">\r\n            {/* Mesh Background Decorations */}\r\n            <div className=\"fixed inset-0 bg-mesh opacity-40 pointer-events-none\" />\r\n\r\n            {/* Sidebar */}\r\n            <motion.aside\r\n                initial={{ x: -20, opacity: 0 }}\r\n                animate={{ x: 0, opacity: 1 }}\r\n                className=\"w-80 bg-slate-950/60 border-r border-white/5 flex flex-col p-6 backdrop-blur-3xl z-30\"\r\n            >\r\n                <div className=\"flex items-center gap-4 mb-10 px-2 leading-tight\">\r\n                    <div className=\"p-3 glass-card shadow-lg shadow-brand-500/10\">\r\n                        <BrainCircuit size={24} className=\"text-brand-400\" />\r\n                    </div>\r\n                    <div>\r\n                        <h1 className=\"text-xl font-black tracking-tighter text-white\">SQL MASTER</h1>\r\n                        <div className=\"flex items-center gap-2 mt-0.5\">\r\n                            <div className=\"w-1.5 h-1.5 rounded-full bg-brand-500 animate-pulse\" />\r\n                            <span className=\"text-[9px] text-slate-500 font-black uppercase tracking-[0.2em]\">Neural Engine v4</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex-1 space-y-10 overflow-y-auto pr-2 custom-scrollbar\">\r\n                    {/* User Section */}\r\n                    <section className=\"space-y-4\">\r\n                        <div className=\"p-5 glass-card border-brand-500/10 bg-brand-500/[0.02]\">\r\n                            <div className=\"flex items-center gap-4 mb-5\">\r\n                                <div className=\"w-12 h-12 rounded-2xl bg-gradient-to-br from-brand-500 to-indigo-600 flex items-center justify-center shadow-xl shadow-brand-500/20 ring-1 ring-white/20\">\r\n                                    <UserIcon size={24} className=\"text-white\" />\r\n                                </div>\r\n                                <div className=\"overflow-hidden\">\r\n                                    <h3 className=\"text-sm font-black text-white truncate\">{username}</h3>\r\n                                    <div className=\"flex items-center gap-1.5 mt-0.5\">\r\n                                        <div className=\"w-1.5 h-1.5 rounded-full bg-emerald-500\" />\r\n                                        <span className=\"text-[10px] text-emerald-500 font-bold uppercase tracking-wider\">Authenticated</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <button\r\n                                onClick={handleLogout}\r\n                                className=\"w-full flex items-center justify-center gap-2 py-3 text-xs font-black text-slate-400 hover:text-white transition-all bg-white/[0.03] hover:bg-white/[0.08] rounded-xl border border-white/5 uppercase tracking-widest\"\r\n                            >\r\n                                <LogOut size={14} /> Close Terminal\r\n                            </button>\r\n                        </div>\r\n                    </section>\r\n\r\n                    {/* Table Ingestion */}\r\n                    <section>\r\n                        <div className=\"flex items-center justify-between mb-4 px-2\">\r\n                            <h2 className=\"text-[10px] font-black text-slate-500 uppercase tracking-[0.3em]\">Data Ingestion</h2>\r\n                            <div className=\"p-1 glass rounded-md\">\r\n                                <Zap size={10} className=\"text-brand-400\" />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <form onSubmit={handleFileUpload} className=\"space-y-4\">\r\n                            <div className=\"group relative\">\r\n                                <input\r\n                                    type=\"file\"\r\n                                    onChange={(e) => {\r\n                                        const selected = e.target.files?.[0];\r\n                                        if (selected) {\r\n                                            setFile(selected);\r\n                                            setTableName(selected.name.split('.')[0].toLowerCase().replace(/[^a-z0-9]/g, '_'));\r\n                                        }\r\n                                    }}\r\n                                    className=\"hidden\"\r\n                                    id=\"file-upload\"\r\n                                    accept=\".csv,.xlsx,.xls\"\r\n                                />\r\n                                <label\r\n                                    htmlFor=\"file-upload\"\r\n                                    className=\"flex flex-col items-center justify-center p-8 glass-card border-dashed border-white/10 hover:border-brand-500/40 hover:bg-brand-500/5 transition-all cursor-pointer group\"\r\n                                >\r\n                                    <div className=\"p-4 bg-slate-900 rounded-2xl mb-4 group-hover:scale-110 transition-transform shadow-2xl border border-white/5\">\r\n                                        <Upload size={24} className=\"text-slate-400 group-hover:text-brand-400\" />\r\n                                    </div>\r\n                                    <span className=\"text-xs font-bold text-slate-400 uppercase tracking-widest text-center px-2\">\r\n                                        {file ? file.name : \"Select Knowledge Base\"}\r\n                                    </span>\r\n                                </label>\r\n                            </div>\r\n\r\n                            <AnimatePresence>\r\n                                {file && (\r\n                                    <motion.div\r\n                                        initial={{ opacity: 0, height: 0 }}\r\n                                        animate={{ opacity: 1, height: \"auto\" }}\r\n                                        exit={{ opacity: 0, height: 0 }}\r\n                                        className=\"space-y-4\"\r\n                                    >\r\n                                        <input\r\n                                            type=\"text\"\r\n                                            placeholder=\"Knowledge Identifier\"\r\n                                            value={tableName}\r\n                                            onChange={(e) => setTableName(e.target.value.toLowerCase().replace(/[^a-z0-9]/g, '_'))}\r\n                                            className=\"w-full bg-slate-900/50 border border-white/5 rounded-xl p-4 text-sm focus:ring-2 focus:ring-brand-500 transition-all outline-none text-white h-12 uppercase tracking-widest placeholder:text-slate-700\"\r\n                                        />\r\n                                        <button\r\n                                            type=\"submit\"\r\n                                            disabled={isUploading}\r\n                                            className=\"btn-primary w-full h-12 text-xs uppercase tracking-[0.2em]\"\r\n                                        >\r\n                                            {isUploading ? <Loader2 size={18} className=\"animate-spin\" /> : <Plus size={18} />}\r\n                                            Sync Knowledge\r\n                                        </button>\r\n                                    </motion.div>\r\n                                )}\r\n                            </AnimatePresence>\r\n                        </form>\r\n                    </section>\r\n\r\n                    {/* Active Knowledge */}\r\n                    <section>\r\n                        <h2 className=\"text-[10px] font-black text-slate-500 uppercase tracking-[0.3em] mb-4 px-2\">Neural Knowledge Map</h2>\r\n                        <div className=\"space-y-3 max-h-72 overflow-y-auto custom-scrollbar pr-2\">\r\n                            {schema && schema.split('Table:').slice(1).map((tableInfo, idx) => {\r\n                                const tableNameMatch = tableInfo.trim().split('\\n')[0];\r\n                                return (\r\n                                    <div key={idx} className=\"glass-card bg-black/40 p-4 border-white/5 ring-1 ring-white/5 group\">\r\n                                        <div className=\"flex items-center justify-between mb-3\">\r\n                                            <span className=\"text-[10px] font-bold text-brand-400 uppercase tracking-widest\">{tableNameMatch}</span>\r\n                                            <button\r\n                                                onClick={() => handleDownload(`SELECT * FROM \"${tableNameMatch}\"`, `${tableNameMatch}.csv`)}\r\n                                                className=\"p-1.5 opacity-0 group-hover:opacity-100 bg-white/5 hover:bg-brand-500/20 text-slate-400 hover:text-brand-400 rounded-md transition-all border border-white/5\"\r\n                                            >\r\n                                                <Download size={10} />\r\n                                            </button>\r\n                                        </div>\r\n                                        <pre className=\"text-[9px] text-slate-500 font-mono leading-relaxed opacity-60\">\r\n                                            {tableInfo.split('\\n').slice(1).join('\\n').trim()}\r\n                                        </pre>\r\n                                    </div>\r\n                                );\r\n                            }) || (\r\n                                    <div className=\"glass-card bg-black/40 p-5 font-mono text-[10px] text-slate-500 italic opacity-50 border-white/5\">\r\n                                        Connect data source to initialize knowledge mapping.\r\n                                    </div>\r\n                                )}\r\n                        </div>\r\n                    </section>\r\n                </div>\r\n            </motion.aside>\r\n\r\n            {/* Main Workspace */}\r\n            <main className=\"flex-1 flex flex-col relative bg-slate-950/20 backdrop-blur-sm z-20\">\r\n                {/* Header bar */}\r\n                <header className=\"h-20 border-b border-white/5 flex items-center justify-between px-10 bg-slate-950/40 backdrop-blur-3xl z-50\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                        <div className=\"flex items-center gap-3 px-4 py-2 glass-card border-emerald-500/20 bg-emerald-500/[0.03]\">\r\n                            <ShieldCheck size={16} className=\"text-emerald-500\" />\r\n                            <span className=\"text-[10px] text-emerald-500 font-black uppercase tracking-[0.3em]\">End-to-End Secure</span>\r\n                        </div>\r\n                        <div className=\"h-6 w-[1px] bg-white/5\" />\r\n                        <div className=\"flex items-center gap-3 text-slate-500\">\r\n                            <Clock size={16} />\r\n                            <span className=\"text-[10px] font-black uppercase tracking-[0.3em]\">System Time: {new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-8\">\r\n                        <div onClick={clearMessages} className=\"flex items-center gap-3 cursor-pointer hover:text-red-400 transition-colors group\">\r\n                            <Trash2 size={16} className=\"text-slate-500 group-hover:text-red-400\" />\r\n                            <span className=\"text-[10px] font-black uppercase tracking-[0.3em] text-slate-500 group-hover:text-red-400\">Clear Logic Path</span>\r\n                        </div>\r\n                        <div\r\n                            onClick={fetchSchema}\r\n                            className=\"p-2.5 glass-card hover:bg-brand-500/10 transition-all cursor-pointer active:scale-90 ring-1 ring-white/5\"\r\n                        >\r\n                            <RefreshCw size={16} className=\"text-brand-400\" />\r\n                        </div>\r\n                    </div>\r\n                </header>\r\n\r\n                {/* Content Area */}\r\n                <div className=\"flex-1 overflow-y-auto p-10 space-y-12 custom-scrollbar relative\">\r\n                    <AnimatePresence>\r\n                        {messages.map((msg, i) => (\r\n                            <motion.div\r\n                                key={i}\r\n                                initial={{ opacity: 0, y: 30 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ duration: 0.6, delay: i * 0.1 }}\r\n                                className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}\r\n                            >\r\n                                <div className={`max-w-3xl relative ${msg.role === 'user' ? 'w-full flex justify-end' : 'w-full'}`}>\r\n                                    {/* User Avatar & Prompt */}\r\n                                    {msg.role === 'user' && (\r\n                                        <div className=\"flex items-start gap-6 flex-row-reverse w-full\">\r\n                                            <div className=\"flex flex-col items-center gap-2 shrink-0\">\r\n                                                <motion.div\r\n                                                    whileHover={{ scale: 1.1, rotate: -5 }}\r\n                                                    className=\"w-16 h-16 rounded-full bg-gradient-to-br from-amber-400 via-orange-500 to-red-600 flex items-center justify-center shadow-[0_0_30px_rgba(245,158,11,0.3)] ring-2 ring-white/30 relative overflow-hidden group\"\r\n                                                >\r\n                                                    <div className=\"absolute inset-0 bg-white/20 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                                                    <UserIcon size={30} className=\"text-white relative z-10\" />\r\n                                                    <div className=\"absolute bottom-0 w-full h-1/3 bg-black/20 backdrop-blur-sm flex items-center justify-center\">\r\n                                                        <span className=\"text-[8px] font-black text-white/80 uppercase truncate px-1\">{username.substring(0, 8)}</span>\r\n                                                    </div>\r\n                                                </motion.div>\r\n                                                <div className=\"w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.5)]\" />\r\n                                            </div>\r\n                                            <motion.div\r\n                                                initial={{ x: 20, opacity: 0 }}\r\n                                                animate={{ x: 0, opacity: 1 }}\r\n                                                className=\"glass-card bg-brand-600/10 border-brand-500/30 p-7 rounded-[2.5rem] rounded-tr-none shadow-2xl shadow-brand-500/5 max-w-2xl relative\"\r\n                                            >\r\n                                                <div className=\"absolute -right-2 top-6 w-4 h-4 bg-brand-600/20 border-r border-t border-brand-500/30 rotate-45 backdrop-blur-3xl\" />\r\n                                                <p className=\"text-base text-white/90 leading-relaxed font-medium\">{msg.content}</p>\r\n                                            </motion.div>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* AI Avatar & Response */}\r\n                                    {msg.role === 'assistant' && (\r\n                                        <div className=\"flex items-start gap-6 w-full\">\r\n                                            <div className=\"flex flex-col items-center gap-2 shrink-0\">\r\n                                                <motion.div\r\n                                                    initial={{ scale: 0.8, opacity: 0 }}\r\n                                                    animate={{ scale: 1, opacity: 1 }}\r\n                                                    whileHover={{ rotate: 360 }}\r\n                                                    transition={{ rotate: { duration: 20, repeat: Infinity, ease: \"linear\" } }}\r\n                                                    className=\"w-18 h-18 rounded-[2rem] bg-gradient-to-tr from-brand-600 via-indigo-600 to-violet-700 flex items-center justify-center shadow-[0_0_50px_rgba(59,130,246,0.4)] ring-4 ring-brand-500/30 shrink-0 relative overflow-hidden group\"\r\n                                                >\r\n                                                    <div className=\"absolute inset-0 bg-brand-400/20 animate-pulse\" />\r\n                                                    <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                                                    <BrainCircuit size={36} className=\"text-white relative z-10 drop-shadow-[0_0_15px_rgba(255,255,255,0.5)]\" />\r\n                                                </motion.div>\r\n                                                <span className=\"text-[9px] font-black text-brand-400 uppercase tracking-widest\">Neural Core</span>\r\n                                            </div>\r\n                                            <div className=\"w-full space-y-6\">\r\n                                                <motion.div\r\n                                                    initial={{ x: -20, opacity: 0 }}\r\n                                                    animate={{ x: 0, opacity: 1 }}\r\n                                                    className=\"glass-card p-10 rounded-[2.5rem] rounded-tl-none ring-1 ring-white/5 shadow-2xl shadow-black/60 bg-slate-900/50 relative overflow-hidden\"\r\n                                                >\r\n                                                    <div className=\"absolute top-0 left-0 w-2 h-full bg-gradient-to-b from-brand-500 to-indigo-600\" />\r\n                                                    <div className=\"text-base md:text-lg text-slate-200 leading-relaxed font-medium whitespace-pre-wrap\">\r\n                                                        {msg.content}\r\n                                                    </div>\r\n\r\n                                                    {/* AMBIGUITY UI */}\r\n                                                    {msg.is_ambiguous && msg.potential_matches && (\r\n                                                        <div className=\"mt-8 p-8 glass-card border-brand-500/30 bg-brand-500/[0.05] shadow-inner shadow-brand-500/10\">\r\n                                                            <div className=\"flex items-center gap-3 mb-6\">\r\n                                                                <div className=\"w-8 h-8 rounded-lg bg-brand-500/20 flex items-center justify-center\">\r\n                                                                    <Layers size={16} className=\"text-brand-400\" />\r\n                                                                </div>\r\n                                                                <h4 className=\"text-[11px] font-black text-brand-400 uppercase tracking-[0.2em]\">Mission Data Selection Required</h4>\r\n                                                            </div>\r\n                                                            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                                                                {msg.potential_matches.map(table => (\r\n                                                                    <label key={table}\r\n                                                                        className={cn(\r\n                                                                            \"flex items-center gap-4 px-5 py-4 bg-slate-950/40 border rounded-2xl cursor-pointer transition-all hover:scale-[1.02] active:scale-95\",\r\n                                                                            selectedForAmbiguity.includes(table) ? \"border-brand-500 bg-brand-500/10 ring-1 ring-brand-500/50 shadow-lg shadow-brand-500/10\" : \"border-white/5 hover:border-white/20\"\r\n                                                                        )}\r\n                                                                    >\r\n                                                                        <div className={cn(\r\n                                                                            \"w-5 h-5 rounded-md border-2 flex items-center justify-center transition-all\",\r\n                                                                            selectedForAmbiguity.includes(table) ? \"bg-brand-500 border-brand-500\" : \"border-white/10 bg-black/20\"\r\n                                                                        )}>\r\n                                                                            {selectedForAmbiguity.includes(table) && <Check size={14} className=\"text-white\" />}\r\n                                                                        </div>\r\n                                                                        <input\r\n                                                                            type=\"checkbox\"\r\n                                                                            className=\"hidden\"\r\n                                                                            checked={selectedForAmbiguity.includes(table)}\r\n                                                                            onChange={(e) => {\r\n                                                                                if (e.target.checked) setSelectedForAmbiguity(prev => [...prev, table]);\r\n                                                                                else setSelectedForAmbiguity(prev => prev.filter(t => t !== table));\r\n                                                                            }}\r\n                                                                        />\r\n                                                                        <span className={cn(\"text-xs font-bold uppercase tracking-widest\", selectedForAmbiguity.includes(table) ? \"text-white\" : \"text-slate-400\")}>{table}</span>\r\n                                                                    </label>\r\n                                                                ))}\r\n                                                            </div>\r\n                                                            <button\r\n                                                                onClick={() => {\r\n                                                                    if (selectedForAmbiguity.length > 0) {\r\n                                                                        const tableString = selectedForAmbiguity.join(', ');\r\n                                                                        const originalReq = messages[i - 1].content;\r\n                                                                        const refinedQuery = `In the table(s) [${tableString}], ${originalReq}`;\r\n                                                                        handleSend(refinedQuery);\r\n                                                                        setSelectedForAmbiguity([]);\r\n                                                                    }\r\n                                                                }}\r\n                                                                className=\"w-full mt-6 py-4 bg-brand-500 hover:bg-brand-600 text-white rounded-2xl font-black text-xs uppercase tracking-[0.3em] shadow-2xl shadow-brand-500/40 transition-all flex items-center justify-center gap-3 disabled:opacity-50 group\"\r\n                                                                disabled={selectedForAmbiguity.length === 0}\r\n                                                            >\r\n                                                                Synchronize Target Profiles <ArrowRight size={18} className=\"group-hover:translate-x-1 transition-transform\" />\r\n                                                            </button>\r\n                                                        </div>\r\n                                                    )}\r\n\r\n                                                    {/* Analysis Block */}\r\n                                                    {(msg.sql || msg.plan) && (\r\n                                                        <div className=\"mt-10 pt-8 border-t border-white/5\">\r\n                                                            <button\r\n                                                                onClick={() => toggleTechDetails(i)}\r\n                                                                className=\"flex items-center gap-3 text-[10px] font-black text-slate-500 uppercase tracking-[0.4em] hover:text-brand-400 transition-all group\"\r\n                                                            >\r\n                                                                <div className={cn(\"p-1 rounded-md bg-white/5 group-hover:bg-brand-500/10\", showTechDetails[i] && \"rotate-180\")}>\r\n                                                                    <ChevronDown size={14} className=\"transition-transform\" />\r\n                                                                </div>\r\n                                                                Advanced Insight Analysis\r\n                                                            </button>\r\n\r\n                                                            <AnimatePresence>\r\n                                                                {showTechDetails[i] && (\r\n                                                                    <motion.div\r\n                                                                        initial={{ opacity: 0, height: 0 }}\r\n                                                                        animate={{ opacity: 1, height: \"auto\" }}\r\n                                                                        exit={{ opacity: 0, height: 0 }}\r\n                                                                        className=\"mt-8 space-y-6 overflow-hidden\"\r\n                                                                    >\r\n                                                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                                                            <div className=\"p-6 glass-card border-brand-500/20 bg-brand-500/[0.03]\">\r\n                                                                                <div className=\"flex items-center gap-3 mb-4 text-[10px] font-black text-brand-400 uppercase tracking-widest\">\r\n                                                                                    <Cpu size={14} /> Neural Logic Plan\r\n                                                                                </div>\r\n                                                                                <p className=\"text-xs text-slate-400 leading-relaxed italic\">{msg.plan}</p>\r\n                                                                            </div>\r\n                                                                            <div className=\"p-6 glass-card border-emerald-500/20 bg-emerald-500/[0.03]\">\r\n                                                                                <div className=\"flex items-center gap-3 mb-4 text-[10px] font-black text-emerald-400 uppercase tracking-widest\">\r\n                                                                                    <Terminal size={14} /> Execution Kernel\r\n                                                                                </div>\r\n                                                                                <div className=\"terminal-box\">\r\n                                                                                    <div className=\"terminal-header\">\r\n                                                                                        <div className=\"terminal-dot bg-red-500/50\" />\r\n                                                                                        <div className=\"terminal-dot bg-amber-500/50\" />\r\n                                                                                        <div className=\"terminal-dot bg-emerald-500/50\" />\r\n                                                                                    </div>\r\n                                                                                    <div className=\"terminal-content\">\r\n                                                                                        <span className=\"text-emerald-500/50 mr-2\">system@sql-master:~$</span>\r\n                                                                                        {msg.sql}\r\n                                                                                        <span className=\"terminal-cursor\" />\r\n                                                                                    </div>\r\n                                                                                </div>\r\n                                                                            </div>\r\n                                                                        </div>\r\n\r\n                                                                        {msg.data && msg.data.length > 0 && (\r\n                                                                            <div className=\"glass-card border-white/5 overflow-hidden\">\r\n                                                                                <div className=\"p-4 bg-white/5 border-b border-white/5\">\r\n                                                                                    <div className=\"flex items-center justify-between gap-3 text-[10px] font-black text-slate-500 uppercase tracking-widest\">\r\n                                                                                        <div className=\"flex items-center gap-2\">\r\n                                                                                            <TableIcon size={14} /> Knowledge Retrieval Snippet\r\n                                                                                        </div>\r\n                                                                                        <button\r\n                                                                                            onClick={() => handleDownload(msg.sql)}\r\n                                                                                            className=\"flex items-center gap-2 px-3 py-1.5 bg-brand-500/10 hover:bg-brand-500/20 text-brand-400 rounded-lg border border-brand-500/20 transition-all\"\r\n                                                                                        >\r\n                                                                                            <Download size={12} /> Download CSV\r\n                                                                                        </button>\r\n                                                                                    </div>\r\n                                                                                </div>\r\n                                                                                <div className=\"p-6 overflow-x-auto\">\r\n                                                                                    <table className=\"w-full text-left border-separate border-spacing-y-2\">\r\n                                                                                        <thead>\r\n                                                                                            <tr>\r\n                                                                                                {Object.keys(msg.data[0]).map(col => (\r\n                                                                                                    <th key={col} className=\"px-5 py-3 text-[10px] font-black text-brand-400 uppercase tracking-widest bg-brand-500/5 rounded-xl border border-white/5\">{col}</th>\r\n                                                                                                ))}\r\n                                                                                            </tr>\r\n                                                                                        </thead>\r\n                                                                                        <tbody>\r\n                                                                                            {msg.data.slice(0, 10).map((row, ridx) => (\r\n                                                                                                <tr key={ridx} className=\"group hover:scale-[1.01] transition-transform\">\r\n                                                                                                    {Object.values(row).map((val, vidx) => (\r\n                                                                                                        <td key={vidx} className=\"px-5 py-4 text-xs text-slate-300 bg-white/[0.02] group-hover:bg-white/[0.04] first:rounded-l-2xl last:rounded-r-2xl border-y border-white/5 first:border-l last:border-r font-medium\">\r\n                                                                                                            {String(val)}\r\n                                                                                                        </td>\r\n                                                                                                    ))}\r\n                                                                                                </tr>\r\n                                                                                            ))}\r\n                                                                                        </tbody>\r\n                                                                                    </table>\r\n                                                                                </div>\r\n                                                                                {msg.data.length > 10 && (\r\n                                                                                    <div className=\"p-3 bg-white/[0.02] text-center text-[10px] font-black text-slate-600 uppercase tracking-[0.3em]\">\r\n                                                                                        Continuing Log Sequence... (+{msg.data.length - 10} items)\r\n                                                                                    </div>\r\n                                                                                )}\r\n                                                                            </div>\r\n                                                                        )}\r\n                                                                    </motion.div>\r\n                                                                )}\r\n                                                            </AnimatePresence>\r\n                                                        </div>\r\n                                                    )}\r\n                                                </motion.div>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </motion.div>\r\n                        ))}\r\n                    </AnimatePresence>\r\n\r\n                    {isProcessing && (\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            className=\"flex justify-start\"\r\n                        >\r\n                            <div className=\"glass-card p-8 rounded-[2rem] rounded-tl-none flex items-center gap-6 shadow-2xl relative overflow-hidden group\">\r\n                                <div className=\"absolute inset-0 bg-brand-600/5 animate-pulse\" />\r\n                                <div className=\"relative\">\r\n                                    <div className=\"absolute inset-0 bg-brand-500/40 blur-lg rounded-full animate-bounce\" />\r\n                                    <Loader2 size={32} className=\"animate-spin text-brand-500 relative z-10\" />\r\n                                </div>\r\n                                <div className=\"relative z-10\">\r\n                                    <p className=\"text-base font-black text-white uppercase tracking-widest\">Querying Neural Core...</p>\r\n                                    <div className=\"flex gap-1.5 mt-2\">\r\n                                        {[0, 1, 2].map(n => (\r\n                                            <motion.div\r\n                                                key={n}\r\n                                                animate={{ opacity: [0.3, 1, 0.3], scale: [1, 1.2, 1] }}\r\n                                                transition={{ duration: 1, repeat: Infinity, delay: n * 0.2 }}\r\n                                                className=\"w-1.5 h-1.5 rounded-full bg-brand-500\"\r\n                                            />\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    )}\r\n                    <div ref={chatEndRef} className=\"h-40\" />\r\n                </div>\r\n\r\n                {/* Input Layer */}\r\n                <footer className=\"p-10 pt-0 relative z-30\">\r\n                    <div className=\"absolute bottom-10 left-1/2 -translate-x-1/2 w-full max-w-4xl px-10 z-50\">\r\n                        <div className=\"glass-card p-2 pr-4 bg-slate-900/60 ring-1 ring-white/10 shadow-[0_0_100px_rgba(59,98,255,0.15)] flex items-center gap-4 border-2 border-brand-500/20 group focus-within:border-brand-500/50 transition-all\">\r\n                            <div className=\"p-4 bg-brand-500/10 rounded-3xl text-brand-400 group-focus-within:bg-brand-500/20 group-focus-within:scale-110 transition-all\">\r\n                                <BrainIcon size={24} />\r\n                            </div>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={query}\r\n                                onChange={(e) => setQuery(e.target.value)}\r\n                                onKeyDown={(e) => e.key === 'Enter' && handleSend()}\r\n                                placeholder=\"Ask the Neural Core anything about your database...\"\r\n                                className=\"bg-transparent border-none focus:ring-0 text-slate-100 placeholder:text-slate-600 text-lg py-5 flex-1 font-medium tracking-tight\"\r\n                            />\r\n                            <button\r\n                                onClick={() => handleSend()}\r\n                                disabled={isProcessing || !query.trim()}\r\n                                className=\"p-5 bg-brand-600 hover:bg-brand-500 text-white rounded-[2rem] shadow-xl shadow-brand-500/30 transition-all hover:scale-110 active:scale-90 disabled:opacity-50 disabled:grayscale hover:rotate-3\"\r\n                            >\r\n                                {isProcessing ? <RefreshCw className=\"animate-spin\" size={20} /> : <Send size={20} />}\r\n                            </button>\r\n                        </div>\r\n                        <div className=\"flex justify-center mt-6 gap-8\">\r\n                            <span className=\"flex items-center gap-2 text-[10px] text-slate-600 font-bold uppercase tracking-[0.3em]\">\r\n                                <div className=\"w-1.5 h-1.5 rounded-full bg-slate-800\" /> Neural Optimizing\r\n                            </span>\r\n                            <span className=\"flex items-center gap-2 text-[10px] text-slate-600 font-bold uppercase tracking-[0.3em]\">\r\n                                <div className=\"w-1.5 h-1.5 rounded-full bg-slate-800\" /> Protocol v4.2.0\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </footer>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default HomePage;\r\n","usedDeprecatedRules":[]}]
